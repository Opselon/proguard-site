# -----------------------------------------------------------------------------
# Ù†Ø§Ù… Workflow: Ø§ÛŒÙ† Ù†Ø§Ù… Ø¯Ø± Ù„ÛŒØ³Øª Actions Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
# -----------------------------------------------------------------------------
name: 'ğŸš€ Build, Test & Deploy ProGuard Site'

# -----------------------------------------------------------------------------
# ØªØ±ÛŒÚ¯Ø±Ù‡Ø§: Ú†Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø§ÛŒÙ† ÙÙ„Ùˆ Ø¨Ø§ÛŒØ¯ Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯ØŸ
# -----------------------------------------------------------------------------
on:
  push:
    branches:
      - master # Ù‡Ø± Ø¨Ø§Ø± Ú©Ù‡ Ú©Ø¯ÛŒ Ø¨Ù‡ Ø´Ø§Ø®Ù‡ master Ù¾ÙˆØ´ Ø´ÙˆØ¯
  workflow_dispatch: # Ø§Ù…Ú©Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ Ø§Ø² ØªØ¨ Actions

# -----------------------------------------------------------------------------
# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù…Ø²Ù…Ø§Ù†ÛŒ: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¯ÛŒÙ¾Ù„ÙˆÛŒâ€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ø²Ù…Ø§Ù† Ùˆ ØªØ¯Ø§Ø®Ù„
# Ø§Ú¯Ø± ÛŒÚ© Ø§Ø¬Ø±Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª Ùˆ Ù¾ÙˆØ´ Ø¬Ø¯ÛŒØ¯ÛŒ Ù…ÛŒâ€ŒØ¢ÛŒØ¯ØŒ Ø§Ø¬Ø±Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ù„ØºÙˆ Ù…ÛŒâ€ŒØ´ÙˆØ¯
# -----------------------------------------------------------------------------
concurrency:
  group: 'pages'
  cancel-in-progress: true

# -----------------------------------------------------------------------------
# Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²: Ø§ÛŒÙ†â€ŒÙ‡Ø§ Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒÛŒ Ù‡Ø³ØªÙ†Ø¯ Ú©Ù‡ ÙÙ„Ùˆ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø± Ø¨Ø§ Ø±ÛŒÙ¾Ø§Ø²ÛŒØªÙˆØ±ÛŒ Ø¯Ø§Ø±Ø¯
# -----------------------------------------------------------------------------
permissions:
  contents: read
  pages: write
  id-token: write

# -----------------------------------------------------------------------------
# ØªØ¹Ø±ÛŒÙ Ø¬Ø§Ø¨â€ŒÙ‡Ø§ (Ù…Ø±Ø§Ø­Ù„ Ø§ØµÙ„ÛŒ): Ù‡Ø± Ø¬Ø§Ø¨ ÛŒÚ© Ù…Ø±Ø­Ù„Ù‡ Ù…Ø³ØªÙ‚Ù„ Ø§Ø³Øª
# -----------------------------------------------------------------------------
jobs:
  # ============================================================================
  # Ø¬Ø§Ø¨ Ø§ÙˆÙ„: Ø³Ø§Ø®Øª ÙˆØ¨â€ŒØ³Ø§ÛŒØª (Build)
  # ÙˆØ¸ÛŒÙÙ‡: Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ØŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ Ùˆ Ø³Ø§Ø®Øª Ù†Ø³Ø®Ù‡ Ù†Ù‡Ø§ÛŒÛŒ Ø³Ø§ÛŒØª (Ù¾ÙˆØ´Ù‡ dist)
  # ============================================================================
  build:
    name: 'ğŸ—ï¸ Build Static Website'
    runs-on: ubuntu-latest
    steps:
      - name: 'ğŸ“¥ Step 1: Checkout Repository'
        uses: actions/checkout@v4

      - name: 'âš™ï¸ Step 2: Setup Node.js Environment'
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'npm'
          cache-dependency-path: 'proguard-site/package-lock.json'

      - name: 'ğŸ“¦ Step 3: Install Project Dependencies'
        run: npm install
        working-directory: ./proguard-site

      - name: 'ğŸ› ï¸ Step 4: Export Static Files'
        run: npm run export
        working-directory: ./proguard-site

      - name: 'ğŸ“¤ Step 5: Upload Artifact for Deployment'
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./proguard-site/dist

  # ============================================================================
  # Ø¬Ø§Ø¨ Ø¯ÙˆÙ…: Ø§Ù†ØªØ´Ø§Ø± ÙˆØ¨â€ŒØ³Ø§ÛŒØª (Deploy)
  # ÙˆØ¸ÛŒÙÙ‡: ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¯Ø± Ø¬Ø§Ø¨ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ú¯Ø±ÙØªÙ‡ Ùˆ Ø±ÙˆÛŒ GitHub Pages Ù…Ù†ØªØ´Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯
  # Ø§ÛŒÙ† Ø¬Ø§Ø¨ ÙÙ‚Ø· Ø²Ù…Ø§Ù†ÛŒ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù‡ Ø¬Ø§Ø¨ `build` Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
  # ============================================================================
  deploy:
    name: 'ğŸš€ Deploy to GitHub Pages'
    needs: build # <--- Ø§ÛŒÙ† Ø®Ø· Ø¬Ø§Ø¯ÙˆÛŒÛŒØŒ Ø§ØªØµØ§Ù„ Ø¨ØµØ±ÛŒ Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯!
    runs-on: ubuntu-latest
    
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
      
    steps:
      - name: 'âœ… Deploy to Production'
        id: deployment
        uses: actions/deploy-pages@v4
